<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-danger">
    <div class="container">
        <span class="navbar-brand">Admin Dashboard</span>
        <a href="/logout" class="btn btn-light">Logout</a>
    </div>
</nav>

<div class="container">

    <!-- Pending Students List -->
    <h3 class="mt-4 text-dark fw-bold">Pending Student Approvals</h3>
    <table class="table table-bordered table-striped">
        <tr><th>Name</th><th>Email</th><th>Action</th></tr>
        {% for stud in pending %}
        <tr>
            <td>{{ stud.name }}</td>
            <td>{{ stud.email }}</td>
            <td><a href="/admin/approve/{{ stud._id }}" class="btn btn-success btn-sm">Approve</a></td>
        </tr>
        {% endfor %}
    </table>


    <!-- Add Event Form -->
    <h3 class="mt-4 fw-bold text-dark">Add New Event</h3>
    <form method="POST" action="/admin/event/add" class="card p-4 shadow col-md-6">

        <input name="club" placeholder="Club Name" class="form-control mb-2" required>
        <input name="event" placeholder="Event Name" class="form-control mb-2" required>
        <input name="capacity" placeholder="Capacity" class="form-control mb-2" required>
        <textarea name="desc" placeholder="Description" class="form-control mb-2" required></textarea>

        <button class="btn btn-primary w-100">Add Event</button>
    </form>


    <!-- All Events -->
    <h3 class="mt-5 fw-bold">All Events</h3>
    <div class="row">
        {% for event in events %}
        <div class="col-md-4">
            <div class="card p-3 shadow mb-3">
                <h5>{{ event.event_name }}</h5>
                <p><b>Club:</b> {{ event.club_name }}</p>
                <p><b>Capacity:</b> {{ event.capacity }}</p>
                <p>{{ event.description }}</p>

                <!-- Update Event -->
                <form method="POST" action="/admin/event/update/{{ event._id }}">
                    <input name="club" class="form-control mb-2" value="{{ event.club_name }}">
                    <input name="event" class="form-control mb-2" value="{{ event.event_name }}">
                    <input name="capacity" class="form-control mb-2" value="{{ event.capacity }}">
                    <textarea name="desc" class="form-control mb-2">{{ event.description }}</textarea>
                    <button class="btn btn-warning w-100 mb-2">Update</button>
                </form>

                <a href="/admin/event/delete/{{ event._id }}" class="btn btn-danger w-100">Delete</a>

                <hr>
                <h6 class="fw-bold">Registered Students:</h6>
                <ul>
                    {% for r in event_regs[event._id|string] %}
                    <li>{{ r.student_name }} ({{ r.student_email }})</li>
                    {% else %}
                    <li class="text-muted">No registrations yet</li>
                    {% endfor %}
                </ul>

            </div>
        </div>
        {% endfor %}
    </div>

</div>

</body>
</html>
